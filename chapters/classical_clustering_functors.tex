\chapter{Classification \& Uniqueness of Classical Clustering Functors}
\label{chapter__classical}
In this chapter all clustering functors are of the classical type.
Our goal in this section is to prove a uniqueness result for the Vietoris-Rips clustering functor $\Rf_\delta$ from Example \ref{exa:classical_vr}.
%
We start by presenting a useful way of constructing clustering functors. Namely, we show that any \emph{excessive} clustering functor can be \emph{represented} by a family of metric spaces. This will give an alternative view on the Vietoris-Rips functor.
%
Next we look at the concept of scale invariance as presented in Theorem \ref{thm:kleinberg} and show that it is too restrictive for our purposes.
%
After this, we are ready to tackle the task of characterizing the Vietoris-Rips functor by defining properties such as \emph{surjectivity}, \emph{spanning}, and \emph{splitting}. Depending on the setting, it will turn out that these conditions are all equivalent and unique to the Vietoris-Rips functor.
%
This chapter is largely based on results presented in \cite{Carlsson2010}.

In this section we restrict ourselves to $\M \in \{\inj, \gen\}$ as it turns out that $\iso$ is too general for our purpose (recall Remark \ref{rem:induced_functor_by_inclusion}).
This is also the setting in which the Vietoris-Rips functor has unique properties.

\begin{myremark}{\cite[Thm.~6.1]{Carlsson2010}}{}
Let $\mathcal{I}$ denote a collection of representatives of isometry classes of finite metric spaces.
For each $X \in \mathcal{I}$ consider the isometry group $\mathrm{Iso}(X)$.
This group acts on $\mathfrak{P}(X)$ via $(\phi, P) \mapsto \phi_*(P)$.
Let $\Xi_X \subseteq \mathfrak{P}(X)$ denote the set of fixed points of this group action.
A clustering functor $\Cf\colon \iso \to \C$ is uniquely determined by a choice of $P_X \in \Xi_X$ for each $X \in \mathcal{I}$.

\medskip
On the one hand, it is clear that if $(X,d) \cong (Y,d')$ are isometric then ${\Cf(X,d) = \Cf(Y,d')}$. On the other hand, if $(X,d) \not\cong (Y,d')$ then there exist no morphisms between $X$ and $Y$ and thus $\Cf(X,d)$ and $\Cf(Y,d')$ can be independently chosen from $\Xi_X$ and $\Xi_Y$ respectively.
\end{myremark}

\Needspace{3\baselineskip}

In some sense, $\iso$ clustering functors can be thought of as any algorithm that ``does not consider any particular ordering'' of the data points.
This is the reason that algorithms like single linkage clustering (with ``tie-breaking'') are not even $\iso$-functorial (see Section \ref{section__linkage_clustering}).

\section{Excessive and Representable Clustering Functors}

We will quickly talk about a simple yet, as we will see, very general way of constructing clustering functors.

\begin{definition}{Excessive \cite[Def.~6.2]{Carlsson2010}}{}
Let $\M \in \{\inj, \gen\}$. A clustering functor $\Cf\colon \M \to \C$ is called \emph{excessive} if for every $(X,d) \in \ob(\M)$ and $(X,P) = \Cf(X,d)$ we have that for every block $X_\alpha \in P$:
$$
\Cf(X_\alpha, d|_{X_\alpha \times X_\alpha}) = (X_\alpha, \{X_\alpha\})
$$
\end{definition}

Let $\Omega$ be a family of finite non-empty metric spaces. Such $\Omega$'s can be used to construct clustering functors. We think of $\Omega$ as being a collection of ``patterns'' and our clustering algorithm as detecting these ``patterns''.

\begin{definition}{Representable \cite[Sec.~6.2]{Carlsson2010}}{construction_of_representable_clustering_functors}
Let $\M \in \{\inj, \gen\}$. We define the clustering functor \emph{represented by $\Omega$} as
$$
\Cf^\Omega\colon \M \to \C
$$
where $\Cf^\Omega(X,d) = (X, P)$ such that $\sim_P$ 
is the equivalence relation generated by
\begin{equation*}
    \forall x,y \in X: \ \exists \omega \in \Omega \,\exists \phi \in \mor_\M(\omega, (X,d)) \ \st \ \{x,y\} \subset \image(\phi) \implies x \sim_P y.
\end{equation*}
Additionally, $\Cf$ is said to be \emph{representable} if there exists some $\Omega$ such that $\Cf = \Cf^\Omega$.
\end{definition}

Let us define a simple metric space that will come in handy on several occasions.
\begin{definition}{}{}
    Let $k \in \N$ and $\delta > 0$. Then, we define the \emph{$k$-simplex} with size $\delta$ as the metric space $\Delta_k(\delta) := (X,d)$ where $X = \{1, \dots, k\}$ and the metric is given by
    $$
    d(i,j) := \begin{cases}
        0 & \text{if } i = j\\
        \delta & \text{otherwise}
    \end{cases} \quad \forall i,j \in X.
    $$
\end{definition}

\begin{example}{}{}
With this notation we get a new way of defining the Vietoris-Rips functor, \ie,
$$
\Rf_\delta = \Cf^{\{\Delta_2(\delta)\}}.
$$
Indeed, if $(X,d) \in \gen$ and $x,y \in X$ then there exists a morphism ${\phi \colon \Delta_2(\delta) \to (X,d)}$ with $\{x,y\} \subset \image(\phi)$ if and only if $d(x,y) \leq \delta$.
\end{example}
The fact that $\Rf_\delta$ is representable is not a coincidence as we will see in the remainder of this section.
\begin{myremark}{\cite[Rem.~6.3]{Carlsson2010}}{}
Notice that for $(X,d) \in \Omega$ we have $\Cf^\Omega(X,d) = (X, \{X\})$.
\end{myremark}

This leads to an alternative characterization of $\Cf^\Omega$.

\begin{proposition}{}{characterization_of_representable}
Let $\M \in \{\inj, \gen\}$. For any $\M$-clustering functor
$$
\Cf\colon \M \to \C
$$
such that $\Cf(X,d)$ is trivial for all $(X,d) \in \Omega$ we have
$$
\Cf^\Omega \refines \Cf.
$$
\end{proposition}

\begin{proof}
Let $(X,d) \in \ob(\M)$ and $(X,P) = \Cf^\Omega(X,d)$ and $(X,Q) = \Cf(X,d)$. We want to show that $P \refines Q$.

Let $x,y \in X$ such that the generating condition of $P$ holds, \ie, there exists $\omega \in \Omega$ and $\phi \in \mor_\M(\omega, (X,d))$ such that $\{x,y\} \subset \image(\phi)$.

Since $\Cf(\omega)$ is trivial by assumption and by functoriality of $\Cf(\omega) \refines_\phi \Cf(X,d)$, we get that $x \sim_Q y$. Taking the transitive closure gives the statement.
\end{proof}

Importantly, $\Cf^\Omega$ is the finest clustering functor such that $\Cf^\Omega(X,d)$ is trivial for all $(X,d) \in \Omega$. The existence of this minimal clustering functor follows from our initial construction in Definition \ref{def:construction_of_representable_clustering_functors}.

\begin{theorem}{\cite[Thm.~6.2]{Carlsson2010}}{}
Let $\M \in \{\inj, \gen\}$. A clustering functor $\Cf\colon \M \to \C$ is representable if and only if it is excessive.
\end{theorem}

\begin{proof}
First we show that $\Cf^\Omega$ is excessive. So let $(X,d) \in \ob(\M)$ and $(X,P) = \Cf^\Omega(X,d)$ with $X_\alpha \in P$.

Let $x,y \in X_\alpha$ such that there exists $\omega \in \Omega$ and $\phi \in \mor_\M(\omega, (X,d))$ such that ${\{x,y\} \subset \image(\phi)}$. But now since $X_\alpha$ is a block of $P$ we must have that $\image(\phi) \subset X_\alpha$. Therefore, we can restrict $\phi$, and we have $\phi|_{X_\alpha} \in \mor_\M(\omega, (X_\alpha, d|_{X_\alpha \times X_\alpha}))$. By taking the transitive closure, we conclude that $\Cf^\Omega(X_\alpha, d|_{X_\alpha \times X_\alpha}) = (X_\alpha, \{X_\alpha\})$ and $\Cf^\Omega$ is excessive.

It remains to show that any excessive clustering functor is representable. For this consider
$$
\Omega := \{(X_\alpha, d|_{X_\alpha \times X_\alpha}): X_\alpha \in P \text{ for } (X, P) = \Cf(X,d) \text{ and } (X,d) \in \ob(\M)\}.
$$
We will show that $\Cf = \Cf^\Omega$. By Proposition \ref{prop:characterization_of_representable} and since $\Cf$ is by definition trivial for all $(X,d) \in \Omega$ we have that $\Cf^\Omega \refines \Cf$.

So it remains to show $\Cf \refines \Cf^\Omega$. To this end let $(X,d) \in \ob(\M)$ and $(X,P) = \Cf(X,d)$ and $(X,Q) = \Cf^\Omega(X,d)$.
Assume that $x,y \in X$ are such that $x \sim_P y$. By definition there exists $\omega \subset X$ and $\omega \in \Omega$ such that $\{x,y\} \subset \omega$. Consider the inclusion $\iota: \omega \hookrightarrow X$ which is a morphism in $\mor_\inj(\omega, (X,d))$. Thus by definition of $\Cf^\Omega$, we have $x \sim_Q y$.
\end{proof}


\section{Scale Invariant Clustering Functors}
Let us quickly talk about scale invariance inspired by \textsc{Kleinberg}'s conditions from Theorem \ref{thm:kleinberg}, discussed in \cite[Sec.~6.6]{Carlsson2010}.

\begin{definition}{Scale Invariance}{scale_invariance}
    A clustering functor $\Cf\colon \M \to \C$ is called \emph{scale invariant} if for all $\lambda > 0$ and $(X,d) \in \ob(\M)$ we have
    \begin{equation*}
        \Cf(X,d) = \Cf(X,\lambda \cdot d).
    \end{equation*}
\end{definition}

We now get two interesting distinct behaviors of scale invariant clustering functors. First we consider the case of $\gen$.

\begin{proposition}{\cite[Thm.~6.5]{Carlsson2010}}{}
    Let $\Cf\colon \gen \to \C$ be a scale invariant clustering functor then one of the following holds:
    \begin{enumerate}
        \item $\Cf(X,d)$ is trivial for all $(X,d) \in \ob(\gen)$
        \item $\Cf(X,d)$ is discrete for all $(X,d) \in \ob(\gen)$
    \end{enumerate}
\end{proposition}

\begin{proof}
    Let $|X| \ge 2$ otherwise the statement is clear.
    Then for any $x \neq x'$ in $X$ we can find $\delta, \delta' > 0$ and morphisms in $\gen$
    $$
    \Delta_2(\delta) \overset{f}\longrightarrow X \overset{g}\longrightarrow \Delta_2(\delta')
    $$
    such that $f(1) = x, f(2) = x', g(x) = 1$ and $g(x') = 2$. By functoriality we get
    $$
    \Cf(\Delta_2(\delta)) \refines_f \Cf(X,d) \refines_g \Cf(\Delta_2(\delta')).
    $$
    Recall that by scale invariance we either have that $\Cf(\Delta_2(\delta))$ is trivial or discrete for all $\delta > 0$.
    So since $x \neq x'$ was arbitrary in $X$, we get that if
    \begin{itemize}
        \item $\Cf(\Delta_2(\delta))$ is trivial, then $\Cf(X)$ is trivial;
        \item $\Cf(\Delta_2(\delta))$ is discrete, then $\Cf(X)$ is discrete.
    \end{itemize}
\end{proof}
In the case of $\inj$ we have a more interesting behavior.
\begin{proposition}{\cite[Thm.~6.6]{Carlsson2010}}{}
    Let $\Cf\colon \inj \to \C$ be a scale invariant functor then there exists a $k \in \N \sqcup \{\infty\}$ such that for all $(X,d) \in \ob(\inj)$:

    \begin{itemize}
        \item If $|X| > k$ then $\mathfrak{C}(X,d)$ is trivial.
        \item If $|X| \le k$ then $\mathfrak{C}(X,d)$ is discrete.
    \end{itemize}

    Notice that if $k \in \{0, \infty\}$ then we recover the behavior from $\gen$.
\end{proposition}

\begin{proof}   
    Notice that for $n \le n'$ there exists a morphism in $\inj$
    $$
    \Delta_n(\delta) \longrightarrow \Delta_{n'}(\delta).
    $$
    Therefore, we get that
    $$
    \Cf(\Delta_n(\delta)) \refines \Cf(\Delta_{n'}(\delta)).
    $$
    On the other hand, any permutation of $\Delta_n(\delta)$ is also a morphism in $\inj$. This gives us that $\Cf(\Delta_n(\delta))$ is either discrete or trivial.

    So together we get that there exists some $k \in \N \sqcup \{\infty\}$ such that
    \begin{itemize}
        \item $\forall n > k: \Cf(\Delta_n(\delta))$ is trivial.
        \item $\forall n \le k: \Cf(\Delta_n(\delta))$ is discrete.
    \end{itemize}
    By scale invariance, this does not depend on $\delta$. We can now repeat the same argument as in the previous proposition to get the statement\footnote{By using $n = |X|$, we can find morphisms $\Delta_n(\delta) \to X \to \Delta_n(\delta')$ in $\inj$.}.
\end{proof}

Following this, we immediately see that scale invariant clustering functors cannot be surjective.

\section{Surjective Clustering Functors}

Another condition in \textsc{Kleinberg}'s impossibility theorem (Theorem \ref{thm:kleinberg}) was richness (Definition \ref{def:richness}). We now extend this notion to clustering functors.

\begin{definition}{Surjective}{}
    A classical clustering functor $\Cf\colon \M \to \C$ is called \emph{surjective} if for every finite set $X$ and every $P \in \P(X)$ there exists a metric $d$ on $X$ such that
    \begin{equation*}
        \Cf(X,d) = (X,P).
    \end{equation*}
\end{definition}

\begin{proposition}{\cite[Rem.~6.1]{Carlsson2010}}{vietoris_rips_is_surjective}
    The Vietoris-Rips functor $\Rf_\delta$ is surjective.
\end{proposition}
\begin{proof}
Let $X$ be a finite set and $P$ a partition of $X$. Define the metric $d$ on $X$ by
\begin{equation*}
    d(x,y) := \begin{cases}
        0 & \text{if } x = y\\
        \delta & x \neq y \text{ and } x \sim_P y\\
        2\delta & \text{otherwise}
    \end{cases}.
\end{equation*}
It is straightforward to check that this is indeed a metric and that $\Rf_\delta(X,d) = (X,P)$.
\end{proof}

\begin{example}{}{}
Let $\delta > 0$ consider $X := \{a,b,c\}$. We would like to check that the Vietoris-Rips functor is indeed able to reach any partition of $X$. Up to permutation, there are three possible partitions of $X$:
\begin{itemize}
    \item $P_1= \{\{a,b,c\}\}$,
    \item $P_2 = \{\{a\}, \{b\}, \{c\}\}$,
    \item $P_3 = \{\{a,b\}, \{c\}\}$.
\end{itemize}
First, let us consider $P_1$. For this we can define the metric $d_1$ on $X$ such that $d_1(i,j) = \delta$ for all $i \neq j$. Then, $\Rf_\delta(X,d_1) = (X,P_1)$.
For $P_2$ we can do something similar and use the metric $d_2$ such that $d_2(i,j) = 2\delta$ for all $i \neq j$, and we get $\Rf_\delta(X,d_2) = (X,P_2)$.
Finally, for $P_3$ we can use the metric $d_3$ with $d_3(a,b) = \delta$ and $d_3(a,c) = d_3(b,c) = 2\delta$. This gives us $\Rf_\delta(X,d_3) = (X,P_3)$.
\end{example}

The following property of surjective clustering functors hints that surjectivity and the Vietoris-Rips functor are closely related.

\begin{definition}{Spanning}{spanning}
    We say that a clustering functor $\Cf\colon \M \to \C$ is \emph{spanning} if for every ${(X,d) \in \ob(\M)}$ we can find $\lambda_0, \lambda_1 > 0$ such that
    \begin{enumerate}
        \item $\Cf(X,\lambda \cdot d)$ is trivial for all $0 < \lambda \le \lambda_0$,
        \item $\Cf(X,\lambda \cdot d)$ is discrete for all $\lambda \ge \lambda_1$.
    \end{enumerate}
\end{definition}

The concept of spanning clustering functors, a term which we introduced here, was previously discussed by \textsc{Carlsson} and \textsc{M\'emoli} as part of the assumptions of a theorem \cite[Thm.~6.4]{Carlsson2010}.

\begin{lemma}{}{surjective_implies_eventually_discrete}
    Let $\M \in \{\inj, \gen\}$ and $\Cf\colon \M \to \C$ be a surjective clustering functor. Then $\Cf$ is spanning.
\end{lemma}

For the proof of this lemma we need to introduce the following notation.

\begin{definition}{}{}
    The \emph{separation} of a metric space $(X,d)$ is given by
    \begin{equation*}
    \sep(X,d) := \sep(X) := \begin{cases}
        0 & \text{if } |X| \le 1\\
        \inf\{d(x,y) \mid x,y \in X, x \neq y\} & \text{otherwise}
    \end{cases}
    \end{equation*}
    and the \emph{diameter}
    \begin{equation*}
    \diam(X,d) := \diam(X) := \sup\{d(x,y) \mid x,y \in X\}.
    \end{equation*}
\end{definition}

Notice that for any metric space $(X,d)$ with $1 < |X| < \infty$ we have
$$
0 < \sep(X) \leq \diam(X) < \infty.
$$

\begin{proof}[Proof of Lemma \ref{lem:surjective_implies_eventually_discrete}]
    Let $(X,d) \in \ob(\M)$, we assume that $|X| > 1$ otherwise the statement follows directly. Since $\Cf$ is surjective there exists metrics $d_0, d_1$ on $X$ such that $\Cf(X,d_0)$ is trivial and $\Cf(X,d_1)$ is discrete.
    \begin{enumerate}
        \item We take
        $$
        \lambda_0 := \frac{\sep(X,d_0)}{\diam(X,d)}.
        $$ 
        Notice that for any $0 < \lambda \le \lambda_0$ we have that $\diam(X,\lambda \cdot d) \le \sep(X,d_0)$. Because of this the function
        \begin{align*}
            f: (X, d_0) &\longrightarrow (X, \lambda \cdot d),\\
            x &\longmapsto x
        \end{align*}
        is distance non-increasing (and injective), \ie\ $f \in \mor_\M((X,d_0), (X,\lambda \cdot d))$.
        By functoriality of $\Cf$, it follows that $\Cf(X,d_0) \refines_f \Cf(X,\lambda \cdot d)$. But, since $f$ is the identity on the set $X$ we have $\Cf(X,d_0) \refines \Cf(X,\lambda \cdot d)$ by \eqref{eq:refinement_via_identity}. Therefore, $\Cf(X,\lambda \cdot d)$ must be trivial.

        \item An analogous argument works if we consider $\lambda \ge \lambda_1$ for
        $$
        \lambda_1 := \frac{\diam(X,d_1)}{\sep(X,d)}
        $$
        and the function
        \begin{align*}
            f: (X, \lambda \cdot d) &\longrightarrow (X, d_1),\\
            x &\longmapsto x.
        \end{align*}
        This concludes the proof since we have $\Cf(X,\lambda \cdot d) \refines \Cf(X,d_1)$ for the same reason as above.
    \end{enumerate}
\end{proof}

\section{Splitting Clustering Functors}

As observed by \cite[Thm.~6.4]{Carlsson2010}, a characterizing property of the Vietoris-Rips functor is its behavior on the space $\Delta_2(\lambda)$. In particular, we have that $\Rf_\delta(\Delta_2(\lambda))$ is trivial if $\lambda \le \delta$ and discrete otherwise.
This motivates the following definition.

\begin{definition}{Splitting}{}
    A clustering functor $\Cf\colon \M \to \C$ is called \emph{splitting} at $\delta_0 > 0$ if we have
    \begin{enumerate}
        \item $\Cf(\Delta_2(\delta))$ is trivial for all $\delta \leq \delta_0$,
        \item $\Cf(\Delta_2(\delta))$ is discrete for all $\delta > \delta_0$.
    \end{enumerate}
\end{definition}

We can now formulate two results that show to what extent splitting is a characterizing property of the Vietoris-Rips functor for $\M \in \{\inj, \gen\}$ \cite[Thm.~6.4]{Carlsson2010}.

\begin{proposition}{}{splitting_vietoris_inj}
    Let $\Cf\colon \inj \to \C$ be a clustering functor that splits at $\delta > 0$. Then we have 
    $$
    \Rf_\delta \refines \Cf.
    $$
\end{proposition}


\begin{proposition}{}{splitting_vietoris_gen}
    Let $\Cf\colon \gen \to \C$ be a clustering functor. Then $\Cf$ is splitting at $\delta > 0$ if and only if 
    $$
    \Cf = \Rf_\delta.
    $$
\end{proposition}

\begin{proof}[Proof of Proposition \ref{prop:splitting_vietoris_inj}]
    Let $(X,d) \in \ob(\inj)$ with $(X,P) = \Cf(X,d)$ and $x \neq y$ in $X$ with $d(x,y) \leq \delta$.
    Then there is a map $f \in \mor_\inj(\Delta_2(\delta), (X,d))$ with $\{x,y\} = \image(f)$.
    Since $\Cf(\Delta_2(\delta))$ is trivial we have by functoriality that $x \sim_P y$.

    Taking the transitive closure we get that $\Rf_\delta(X,d) \refines P$ and the statement follows since $(X,d) \in \ob(\inj)$ was arbitrary.
\end{proof}

\begin{proof}[Proof of Proposition \ref{prop:splitting_vietoris_gen}]
    For the converse we notice that clearly $\Rf_\delta$ is splitting at $\delta$.

    \medskip
    Let $\Cf$ be splitting at $\delta$. In view of the previous proposition it remains to show that $\Cf \refines \Rf_\delta$.
        
    Let $(X,d) \in \ob(\gen)$ with $(X,P) = \Cf(X,d)$ and $(X,R) = \Rf_\delta(X,d)$. We show that $P \refines R$, more precisely, we show that for all $x,y \in X$ we have $x \not\sim_R y \implies x \not\sim_P y$. For this we define
    $$
    \delta_0 := \min\{d(x,y) \mid x,y \in X \text{ and } x \not\sim_R y\}.
    $$
    Let now $x,y \in X$ such that $x \not\sim_R y$.
    Then we can find a map $f \in \mor_\gen((X,d), \Delta_2(\delta_0))$ such that $f(x) \neq f(y)$.
    One particular way to construct such an $f$ would be to send every $x' \sim_R x$ to one point in $\Delta_2(\delta_0)$ and every $x' \not\sim_R x$ to the other point. By the way we defined $\delta_0$, this map is in fact distance non-increasing.

    Since $\delta_0 > \delta$ and $\Cf$ is splitting we get $f(x) \not\sim f(y)$ so by functoriality we have $x \not\sim_P y$.
\end{proof}

\Needspace{12\baselineskip}

\begin{example}{}{}
In some sense, the two previous propositions are the best we can get.
For $\delta>0$ consider the clustering functor $\bar\Rf_\delta\colon \inj \to \C$ defined by
$$
\bar\Rf_\delta(X,d) := \Rf_{\frac{\delta|X|}{2}}(X,d).
$$
$\bar\Rf_\delta$ is splitting at $\delta$.

\medskip
To see that $\bar\Rf_\delta$ is indeed a clustering functor consider metric spaces ${(X,d), (Y,d') \in \ob(\inj)}$ and a morphism $f \in \mor_\inj((X,d), (Y,d'))$. By injectivity of $f$ we immediately get that $|X| \le |Y|$. And we have
$$
\bar\Rf_\delta(X,d) = \Rf_{\frac{\delta|X|}{2}}(X,d) \overset{(1)}\refines \Rf_{\frac{\delta|Y|}{2}}(X,d) \overset{(2)}\refines_f \Rf_{\frac{\delta|Y|}{2}}(Y,d') = \bar\Rf_\delta(Y,d'),
$$
where $(1)$ follows from the fact that $|X| \le |Y|$ and $(2)$ follows from the fact that $\Rf_{\delta'}$ is $\inj$ functorial for any $\delta' > 0$. Therefore, $\bar\Rf_\delta$ is an $\inj$ clustering functor.

\medskip
Using a similar argument to the one we used to show that $\Rf_{\delta'}$ is surjective, we can also show that $\bar\Rf_\delta$ is surjective.
\end{example}

\section{Uniqueness of the Vietoris-Rips Functor}

As previously mentioned, the Vietoris-Rips functor is surjective.
In this section we present the new result that under certain technical assumptions the Vietoris-Rips is the unique surjective $\gen$ clustering functor.

In Chapter \ref{chapter__hierarchical} we will discuss the implications this has on \textsc{Kleinberg}'s theorem (Theorem \ref{thm:kleinberg}).

\begin{definition}{Regularity}{regular}
    A clustering functor $\Cf\colon \M \to \C$ is \emph{regular} if for all $(X,d) \in \ob(\M)$ there exists some $\lambda \in (0, 1)$ such that
    $$
    \Cf(X,d) = \Cf(X, \lambda \cdot d).
    $$
\end{definition}

Notice that $\Rf_\delta$ is regular. 
The reason we ask for $\lambda \in (0,1)$ and not $\lambda \in (1, \infty)$ is that this corresponds to the regularity condition \ref{rem:regularity_of_dendrograms} for dendrograms.

\begin{myremark}{}{regularity_classical_clustering_functors}
It might seem overly restrictive to ask for regularity.
However, if we take some $(X, d) \in \ob(\M)$ and consider the function 
$$
\lambda \mapsto \Cf(X, \lambda \cdot d),
$$
which is piecewise constant and takes only finitely many values.
Regularity ensures that this function is constant on intervals of the form $(a, b]$ for some $a < b$.

This ensures compatibility with the regularity condition for dendrograms from Definition \ref{def:dendrogram}.
\end{myremark}

Assuming regularity and building on Lemma \ref{lem:surjective_implies_eventually_discrete}, we can now finally show that the Vietoris-Rips functor is the only surjective regular $\gen$ clustering functor.

\begin{theorem}{Uniqueness Theorem (Classical)}{uniqueness_of_surjective_regular_functors}
    Let $\Cf\colon \gen \to \C$ then the following are equivalent:

    \begin{itemize}
        \item $\Cf$ is surjective and regular,
        \item $\Cf = \Rf_{\delta}$ for some $\delta > 0$.
    \end{itemize}
\end{theorem}

For the proof of this theorem we use the following lemma.

\begin{lemma}{}{surjective_implies_splitting}
    Let $\Cf\colon \M \to \C$ be a surjective regular clustering functor. Then $\Cf$ is splitting at some $\delta > 0$.
\end{lemma}

\begin{proof}[Proof of Lemma]
    Let $\lambda \ge \lambda'$, we consider the identity
    \begin{align*}
        \mathrm{id}: (X, \lambda \cdot d) &\longrightarrow (X, \lambda' \cdot d),\\
        x &\longmapsto x,
    \end{align*}
    which is distance non-increasing, so by functoriality and by refinement via the identity \eqref{eq:refinement_via_identity} we have
    \begin{equation}
    \label{eq:lemma_5_19_1}
    \Cf(X, \lambda \cdot d) \refines_\mathrm{id} \Cf(X, \lambda' \cdot d) \implies \Cf(X, \lambda \cdot d) \refines \Cf(X, \lambda' \cdot d)
    \end{equation}
    for all $\lambda \ge \lambda'$.

    Consider now $(X,d) := \Delta_2(\lambda)$. It is clear that
    \begin{align*}
        \R_{\geq0} &\longrightarrow \P(X), \\
        \lambda &\longmapsto \Cf(\Delta_2(\lambda))
    \end{align*}
    is piecewise constant and can take at most two values (either discrete or trivial), but by Lemma \ref{lem:surjective_implies_eventually_discrete} this function takes exactly two values and by \eqref{eq:lemma_5_19_1} this function is also monotonically decreasing (with respect to $\le$ on $\R_{\geq0}$ and $\refines$ on $\P(X)$).
    So we can find some $\delta_0 > 0$ such that $\Cf(\Delta_2(\delta))$ is trivial and $\Cf(\Delta_2(\delta'))$ is discrete for all $\delta < \delta_0 < \delta'$.

    As for the value at $\delta_0$ we recall Remark \ref{rem:regularity_classical_clustering_functors} and conclude that $\Cf(\Delta_2(\delta_0))$ is trivial. Therefore, $\Cf$ is splitting at $\delta_0$.
\end{proof}

\begin{proof}[Proof of Theorem]
    For the first implication, recall that in Proposition \ref{prop:vietoris_rips_is_surjective} we have already shown that $\Rf_\delta$ is surjective. Moreover, it is also regular.

    Assuming that $\Cf$ is regular and surjective, from the above lemma we get that $\Cf$ is splitting at some $\delta > 0$ so by Proposition \ref{prop:splitting_vietoris_gen} we have that $\Cf = \Rf_{\delta}$.
\end{proof}
