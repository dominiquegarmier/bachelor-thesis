\chapter{Hierarchical Clustering Functors}

\begin{defprop}{Vietoris-Rips functor}{hierarchical_vr}
For $\M \in \{\gen,\inj,\iso\}$ we can define the Vietoris-Rips hierarchical clustering
$$
\Rf: \M \to \H
$$
where for $(X,d) \in \ob(\M)$ and $r \in \R_{\geq0}$ we have
$$
\Rf(X,d; r) := \Rf_r(X,d).
$$
Notice that since $\Rf_\delta \refines \Rf_{\delta'}$ for $\delta \leq \delta'$, this is indeed a hierarchical functor.
\end{defprop}


\begin{definition}{}{}
    A hierarchical clustering functor $\Hf$ is said to be \emph{surjective} if for every possible output of a hierarchical clustering functor \ie\ $(X, \theta_X) \in \ob(\H)$ there exists a metric $d$ on $X$ such that $\Hf(X,d) = (X, \theta_X)$.
\end{definition}

Notice given some surjective hierarchical clustering functor $\Hf$ then any $t \in \R_{\geq0}$ induces a surjective classical clustering functor $\Cf_t(X,d) := \Hf(X, d; t)$.


\todo[I need to find out if this is equivalent]
One could define an alternative notion of surjectivity by asking that the induced functor $\Cf_t$ is surjective for all $t \in \R_{\geq0}$.

A similar concept to scale invariance is given by the following.

\begin{definition}{}{}
A hierarchical clustering functor $\Hf: \M \to \H$ is called \emph{scaling} if for all $(X,d) \in \ob(\M)$ and $\lambda > 0$ we have
$$
\Hf(X, \lambda d) = \sigma_\lambda \Hf(X,d)
$$
\end{definition}

\begin{proposition}{}{}
The Vietoris-Rips functor $\Rf: \M \to \H$ is surjective and scaling.
\end{proposition}



Extending the Vietoris-Rips functor to a hierarchical clustering functor can be done more generally for any regular classical clustering functor.
\begin{proposition}{}{scaling_extension_correspondence}
Let $\M \in \{\gen,\inj\}$ then there exists a one to one correspondence between regular classical clustering functors and scaling hierarchical clustering functors.

\medskip
More precisely given a regular classical clustering functor $\Cf: \M \to \C$ there exists a unique scaling hierarchical clustering functor $\Hf_\Cf: \M \to \H$ such that we have
$$
\Hf_\Cf(X,d; 1) = \Cf(X,d) \quad \forall (X,d) \in \ob(\M).
$$
And any hierarchical clustering functor is of this form.
\end{proposition}

\begin{proof}
Given a regular classical clustering functor $\Cf: \M \to \C$ we can define
$$
\Hf_\Cf(X,d; r) := \Cf(X, r \cdot d) \quad \forall (X,d) \in \ob(\M), r \in \R_{\geq0}.
$$
This indeed defines a hierarchical clustering functor since for $r \geq r'$ the identity map $\id: (X, r \cdot d) \to (X, r' \cdot d)$ is distance non-increasing and thus by functoriality of $\Cf$ we have $\Hf_\Cf(X,d;r) = \Cf(X, r d) \refines \Cf(X, r' d) = \Hf_\Cf(X,d;r')$. And because $\Cf$ is regular $\Hf$ meets all the requirements of a dendogram. \todo[mention why this is the case?] Clearly $\Hf_\Cf$ is scaling and has the desired property.

On the other hand given any hierarchical clustering functor $\Hf: \M \to \H$ we can take $\Cf(X,d) := \Hf(X,d; 1)$ which is a regular classical clustering functor such that $\Hf = \Hf_\Cf$.
\end{proof}

\section{Kleinberg's Conditions}

\textsc{Carlsson} and \textsc{Memoli} mention that \textsc{Kleinberg}'s Conditions of impossibility \ref{thm:kleinberg} can be rephrased in the context of hierarchical clustering functors 
\cite[Comment~7.3.1]{Carlsson2010}.

\begin{definition}{Modified Kleinberg Conditions}{}
    We say that a hierarchical clustering $\Hf: \M \to \H$ functor fulfills the \emph{modified Kleinberg conditions} if all the following holds:
    \begin{enumerate}
        \item $\Hf$ is $\gen$ functorial.
        \item $\Hf$ is surjective
        \item $\Hf$ is scaling
    \end{enumerate}
\end{definition}

As we have seen and as remarked by \cite{Carlsson2010}\source[exact citation] $\Rf$ fulfills the modified Kleinberg conditions.

Using the uniqueness result of theorem \ref{thm:uniqueness_of_surjective_regular_functors} we can now show that the modified Kleinberg conditions uniquely characterize the Vietoris-Rips functor.

\begin{theorem}{Uniqueness of Kleinberg's Conditions}{kleinbergs_uniqueness_conditions}
    Let $\Hf: \M \to \H$ be a hierarchical clustering functor that fulfills the modified Kleinberg conditions then
    $$
    \Hf = \sigma_\delta \Rf
    $$
    \newresult[check this]
\end{theorem}

\begin{proof}
Let $\Hf: \M \to \H$ be a hierarchical clustering functor fulfilling the modified Kleinberg conditions. \Ie\ In particular we have $\M = \gen$.

By proposition \ref{prop:scaling_extension_correspondence} there exists a regular classical clustering functor $\Cf: \gen \to \C$ such that $\Hf = \Hf_\Cf$.

Since $\Hf$ is surjective we have that $\Cf$ is also surjective. So by theorem \ref{thm:uniqueness_of_surjective_regular_functors} we have that $\Cf = \Rf_\delta$ for some $\delta > 0$. Unraveling the definitions we get that $\Hf = \Hf_\Cf = \sigma_\delta \Rf$.
\end{proof}
